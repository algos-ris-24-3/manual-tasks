## Вариант 6

Пропускная способность дуг сети указана в таблице.

|          Дуги          | sa  | sb  | sc  | ca  | ab  | cb  | bd  | dt  | at  |
| :--------------------: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
| Пропускная способность |  6  |  6  |  4  |  5  |  5  |  5  | 10  |  8  |  8  |

Вершины сети: источник **s**, сток **t**, промежуточные вершины: **a**, **b**, **c**, **d**.

---

### 1. Построим сеть с источником s, стоком t и указанными пропускными способностями дуг

Исходная сеть содержит следующие дуги с пропускными способностями:

![image](https://storage.yandexcloud.net/bigbob/Bob/image.png)

---

### 2. Построим начальную остаточную сеть

Построим остаточную сеть.
Изначально локальный поток сети не задан, соответственно в остаточную сеть необходимо вынести обратную дугу с весом равным пропускной способности.

![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(2).png>)

---

### 3. Поиск увеличивающих путей в остаточной сети

Далее ищем **увеличивающие пути** в остаточной сети от стока t к источнику s, находим минимальный вес на пути, уменьшаем его по дугам пути и добавляем/обновляем обратные дуги, после чего корректируем потоки в исходной сети.

#### Шаг 1. Первый увеличивающий путь

В остаточной сети имеется путь:

t → a → s.

Минимальный вес на пути:

Δ₁ = min(8, 6) = 6.

![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(3).png>)

Это значит, что в исходной сети можно увеличить поток на 6 единиц вдоль пути:

s → a → t.

**Обновление остаточной сети после шага 1**

- на дуге t → a уменьшаем остаточную пропускную способность:
  - 8 − 6 = 2;
- на дуге a → s:
  - 6 − 6 = 0, дуга удаляется из остаточной сети;
- добавляем обратные дуги к использованному пути (или увеличиваем их вес):
  - s → a — появляется с остаточной пропускной способностью 6;
  - a → t — появляется с остаточной пропускной способностью 6 (обратная к путевому использованию дуги at).

Все остальные дуги остаточной сети остаются как были.

![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(4).png>)

**Обновление потоков в исходной сети после шага 1**

В исходной сети по дугам пути s → a → t идёт поток 6:

- f_sa = 6, c_sa = 6;
- f_at = 6, c_at = 8;

Остальные дуги пока имеют поток 0.
Суммарный поток |f| = 6.
![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(5).png>)

---

#### Шаг 2. Второй увеличивающий путь

Следующий увеличивающий путь:

t → d → b → s.

Минимальный вес на пути:

Δ₂ = min(8, 10, 6) = 6.

В исходной сети этому соответствует путь:

s → b → d → t

с приращением потока 6.
![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(6).png>)

**Обновление остаточной сети после шага 2**

По пути t → d → b → s:

Добавляем обратные дуги:

![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(7).png>)

Прочие дуги остаточной сети сохраняются с прежними значениями.

**Обновление потоков в исходной сети после шага 2**

Теперь в исходной сети по второму пути s → b → d → t идёт поток 6. Остальные дуги — поток 0.

Суммарный поток:

|f| = 6 (по s→a→t) + 6 (по s→b→d→t) = 12.
![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(8).png>)

---

#### Шаг 3. Третий увеличивающий путь

Следующий увеличивающий путь:

t → a → c → s.

![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(9).png>)

Минимальный вес на пути:

Δ₃ = min(2, 5, 4) = 2.

Это соответствует увеличению потока в исходной сети по пути:

s → c → a → t

**Обновление остаточной сети после шага 3**

По дугам пути t → a → c → s:

- t → a: 2 − 2 = 0, дуга удаляется;
- a → c: 5 − 2 = 3;
- c → s: 4 − 2 = 2.

Добавляем/обновляем обратные дуги:

- a → t: было 6, становится 6 + 2 = 8 (обратная к использованию at);
- c → a: появляется с весом 2;
- s → c: появляется с весом 2 (обратная к использованию sc).
  ![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(10).png>)
  **Обновление потоков в исходной сети после шага 3**

По пути s → c → a → t:

- f_sc = 2 (из 0 до 2),
- f_ca = 2 (из 0 до 2),
- f_at = 6 + 2 = 8.

Обновлённые потоки:

остальные дуги по-прежнему имеют поток 0.

Суммарный поток:

- на выходе из s: 6 + 6 + 2 = 14;
- на входе в t: 8 + 6 = 14.

|f| = 14.
![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(11).png>)

---

#### Шаг 4. Четвёртый увеличивающий путь

Следующий увеличивающий путь:

t → d → b → c → s.

Остаточные пропускные способности этих дуг:

- t → d = 2 (после шага 2 осталось 2),
- d → b = 4,
- b → c = 5,
- c → s = 2 (после шага 3).

Минимальный вес на пути:

Δ₄ = min(2, 4, 5, 2) = 2.

Это означает, что в исходной сети можем увеличить поток на 2 по пути:

s → c → b → d → t.
![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(12).png>)
**Обновление остаточной сети после шага 4**

По дугам пути t → d → b → c → s:

- t → d: 2 − 2 = 0, дуга удаляется;
- d → b: 4 − 2 = 2;
- b → c: 5 − 2 = 3;
- c → s: 2 − 2 = 0, дуга удаляется.

Добавляем/обновляем обратные дуги:

После этого из вершины t в остаточной сети больше не выходит дуг с положительной остаточной пропускной способностью, т.е. увеличивающих путей от t к s больше нет — алгоритм завершает работу.
![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(13).png>)
**Обновление потоков в исходной сети после шага 4**

По пути s → c → b → d → t увеличиваем поток на 2:

Следовательно, величина потока |f| = 16.
![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(15).png>)

---

### 4. Проверка максимальности потока через минимальный разрез сети

Разрез сети — разбиение множества вершин на два подмножества V₁ и V₂, где:

- источник s ∈ V₁,
- сток t ∈ V₂.

Пропускная способность разреза C(V₁, V₂) — сумма пропускных способностей всех дуг, которые начинаются в вершинах из V₁ и оканчиваются в вершинах из V₂.

У нас 6 вершин: {s, a, b, c, d, t}.  
Вершины s и t зафиксированы: s всегда в V₁, t всегда в V₂.  
Остальные вершины {a, b, c, d} могут принадлежать либо V₁, либо V₂, всего вариантов:

2⁴ = 16 разрезов.

Перечислим все разрезы, задавая V₁ и V₂, и найдём их пропускные способности.

| №   | V₁                                 | V₂            | Пропускная способность разреза |
| --- | ---------------------------------- | ------------- | ------------------------------ |
| 1   | s                                  | a, b, c, d, t | 16                             |
|     | **s + одна вершина из a, b, c, d** |               |                                |
| 2   | s, a                               | b, c, d, t    | 23                             |
| 3   | s, b                               | a, c, d, t    | 20                             |
| 4   | s, c                               | a, b, d, t    | 22                             |
| 5   | s, d                               | a, b, c, t    | 24                             |
|     | **s + пара вершин из a, b, c, d**  |               |                                |
| 6   | s, a, b                            | c, d, t       | 22                             |
| 7   | s, a, c                            | b, d, t       | 24                             |
| 8   | s, a, d                            | b, c, t       | 31                             |
| 9   | s, b, c                            | a, d, t       | 21                             |
| 10  | s, b, d                            | a, c, t       | 18                             |
| 11  | s, c, d                            | a, b, t       | 30                             |
|     | **s + три вершины из a, b, c, d**  |               |                                |
| 12  | s, a, b, c                         | d, t          | 18                             |
| 13  | s, a, b, d                         | c, t          | 20                             |
| 14  | s, a, c, d                         | b, t          | 32                             |
| 15  | s, b, c, d                         | a, t          | 19                             |
|     | **s + все вершины a, b, c, d**     |               |                                |
| 16  | s, a, b, c, d                      | t             | 16                             |

![alt text](<https://storage.yandexcloud.net/bigbob/Bob/image%20(14).png>)

Минимальная пропускная способность разреза равна 16 ( {s, a, b, c, d} / {t} ) или ( {s} / {t, a, b, c, d} ), что совпадает с найденной величиной максимального потока в сети.

Ответ:
Максимальный поток в сети равен 16, он реализуется следующим локальными потоками:
