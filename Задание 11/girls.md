# Вариант 2
Пропускная способность дуг сети и стоимость транспортировки указана в таблице.

| Дуги                      | sd | sb | sa | ac | bd | bc | dc | ct |
|:--------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность    | 3  | 4  | 5  | 5  | 4  | 4  | 3  | 10 |
| Стоимость транспортировки | 4  | 3  | 1  | 2  | 2  | 3  | 1  | 2  |

### 1. Построение сети с источником s, стоком t и указанными пропускными способностями дуг для поиска максимального потока.

![image](https://github.com/KhudyakovaSvetlana/images/blob/main/11-1.png)

Построим соответствующую остаточную сеть.

КАРТИНКА

В остаточной сети найден увеличивающий путь t -> с -> a -> s. Минимальный вес дуг на этом пути равен 5.

![image](https://github.com/KhudyakovaSvetlana/images/blob/main/11-2.png)

Уменьшим вес дуг на найденном пути.

КАРТИНКА

### 2. Поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> с -> b -> s. Минимальный вес дуг на этом пути равен 4.

![image](https://github.com/KhudyakovaSvetlana/images/blob/main/11-3.png)

Уменьшим вес дуг на найденном пути.

КАРТИНКА

### 3. Продолжение поиска увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> c -> d -> s. Минимальный вес дуг на этом пути равен 1.

![image](https://github.com/KhudyakovaSvetlana/images/blob/main/11-4.png)

Уменьшим вес дуг на найденном пути.

КАРТИНКА

### 4. Продолжение поиска увеличивающего пути в остаточной сети

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 10 является максимальным для данной сети.

![image](https://github.com/KhudyakovaSvetlana/images/blob/main/11-5.png)

Строим график локальной сети:

![image](https://github.com/KhudyakovaSvetlana/images/blob/main/11-6.png)

### 5. Рассчитаем стоимость полученного максимального потока.

| Дуги                                          | sd | sb | sa | ac | bd | bc | dc | ct | Итого  |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)                   | 3  | 4  | 5  | 5  | 4  | 4  | 3  | 10 |        |
| Локальный поток f(e)                          | 1  | 4  | 5  | 5  | 0  | 4  | 1  | 10 |        |
| Стоимость транспортировки единицы потока c(e) | 4  | 3  | 1  | 2  | 2  | 3  | 1  | 2  |        |
| Суммарная стоимость f(e)*c(e)                 | 4  | 12 | 5  | 10 | 0  | 12 | 1  | 20 | **64** |

Стоимость полученного потока составляет 64. 

### 6. Уменьшаем стоимость потока.
Построим остаточную сеть.
Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

КАРТИНКА

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> b -> c -> d -> s (- 3 - 3 + 1 + 4 = -1). 

КАРТИНКА

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.  

КАРТИНКА

Минимальный вес ребра в цикле 2 - это неиспользованный резерв ребра c -> d.

Удалим найденный цикл - уменьшим на 2 вес всех ребер, входящих в цикл.

Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

КАРТИНКА

### 6. Повторный поиск цикла отрицательной стоимости в остаточной сети.

В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.

### 7. Рассчитаем стоимость полученного максимального потока.

| Дуги                                          | sd | sb | sa | ac | bd | bc | dc | ct | Итого  |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)                   | 3  | 4  | 5  | 5  | 4  | 4  | 3  | 10 |        |
| Локальный поток f(e)                          | 3  | 2  | 5  | 5  | 0  | 2  | 3  | 10 |        |
| Стоимость транспортировки единицы потока c(e) | 4  | 3  | 1  | 2  | 2  | 3  | 1  | 2  |        |
| Суммарная стоимость f(e)*c(e)                 | 12 | 6  | 5  | 10 | 0  | 6  | 3  | 20 | **62** |

Стоимость полученного потока составляет 62. 

### Ответ:
Максимальный поток в сети равен 10, минимальная стоимость потока 62, она реализуется следующим локальными потоками:

КАРТИНКА
